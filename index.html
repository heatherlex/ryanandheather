<script>
const video = document.getElementById('introVideo');
const overlayMessage = document.getElementById('overlayMessage');
const videoContainer = document.getElementById('videoContainer');
const formContainer = document.getElementById('formContainer');
const topSkipMessage = document.getElementById('topSkipMessage');

let hasStarted = false;
let canSkip = false;

function startVideo() {
  if (!hasStarted) {
    hasStarted = true;
    video.style.display = 'block';
    overlayMessage.style.display = 'none';
    topSkipMessage.style.display = 'block';

    video.muted = true;
    video.play().then(() => {
      // Wait for 'playing' event to safely unmute
    }).catch(err => console.error('Playback error:', err));
  }
}

function enableSkip() {
  video.muted = false;
  canSkip = true;
}

function skipVideo() {
  if (canSkip) {
    video.pause();
    video.style.display = 'none';
    topSkipMessage.style.display = 'none';
    formContainer.style.display = 'flex';
    document.body.style.overflow = 'auto';
  }
}

video.addEventListener('playing', () => {
  if (hasStarted && video.muted) {
    enableSkip();
  }
});

video.addEventListener('ended', skipVideo);

videoContainer.addEventListener('click', () => {
  if (!hasStarted) startVideo();
  else if (canSkip) skipVideo();
});
</script>
